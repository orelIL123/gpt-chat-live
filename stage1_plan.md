# תוכנית שלב 1: שיפורי ליבה והתאמה אישית לווידג'ט הצ'אט

## מטרות

*   שיפור המעורבות (Engagement) של המשתמשים.
*   הוספת ערך בסיסי לווידג'ט.
*   שמירה על פשטות ההטמעה (שורה אחת).

## פיצ'רים ליישום

1.  **אנימציית פעימה (Pulse Animation):**
    *   **תיאור:** הוספת אנימציה עדינה לכפתור הלוגו כדי למשוך תשומת לב.
    *   **יישום:** הוספת כללי CSS ייעודיים לאלמנט `chatButton`.

2.  **הודעת פתיחה אוטומטית:**
    *   **תיאור:** הווידג'ט ייפתח אוטומטית אחרי מספר שניות ותוצג הודעת פתיחה.
    *   **יישום:**
        *   שימוש ב-`setTimeout` (למשל, 5 שניות) להפעלת פונקציה.
        *   הפונקציה תבדוק אם החלון כבר פתוח. אם לא, היא תשנה את `chatWindow.style.display` ל-`'flex'`.
        *   הפונקציה תקרא ל-`appendMessage('bot', 'היי אני vegos העוזר החכם שלך לכל מה שתצטרך')` כדי להציג את ההודעה.

3.  **שמירת היסטוריית שיחה:**
    *   **תיאור:** שמירת השיחה ב-`localStorage` של הדפדפן כדי למנוע איבוד מידע בסגירה/ריענון/ניווט. השיחה תישמר ללא הגבלת זמן (לא תתבצע מחיקה אוטומטית).
    *   **יישום:**
        *   יצירת מערך גלובלי `chatHistory = []`.
        *   בטעינת הסקריפט (`DOMContentLoaded`):
            *   לבדוק אם קיים `localStorage.getItem('chatHistory')`.
            *   אם כן, לטעון (`JSON.parse`), לאתחל את `chatHistory` ולשחזר את ההודעות ב-`chatBody` באמצעות `appendMessage`.
        *   בפונקציה `appendMessage(role, text)`:
            *   להוסיף `{ role, text }` למערך `chatHistory`.
            *   לשמור את המערך המעודכן ב-`localStorage.setItem('chatHistory', JSON.stringify(chatHistory))`.

4.  **מיקום ברירת מחדל:**
    *   **תיאור:** המיקום נשאר קבוע בקוד (`bottom: "20px", left: "20px"`). לא תתווסף אפשרות לבעל האתר לשנות זאת בשלב זה.

## תרשים זרימה (Mermaid)

```mermaid
graph TD
    A[טעינת הווידג'ט] --> B{האם קיימת היסטוריה ב-LocalStorage?};
    B -- כן --> C[טעינת היסטוריה והצגתה];
    B -- לא --> D[המשך רגיל];
    C --> D;
    D --> E[המתנה 5 שניות];
    E --> F{האם החלון כבר פתוח?};
    F -- לא --> G[פתיחת חלון אוטומטית];
    G --> H[הצגת הודעת פתיחה "היי אני vegos..."];
    F -- כן --> I[לא לעשות כלום];
    H --> I;

    J[אינטראקציה של משתמש/בוט] --> K[הצגת הודעה ב-DOM];
    K --> L[הוספת הודעה למערך chatHistory];
    L --> M[שמירת chatHistory ב-LocalStorage];

    subgraph אנימציה
        N[כפתור צ'אט] -- CSS --> O(אנימציית פעימה)
    end

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style E fill:#ccf,stroke:#333,stroke-width:1px
    style J fill:#cfc,stroke:#333,stroke-width:1px
    style M fill:#ffc,stroke:#333,stroke-width:1px
```

## הערות נוספות

*   כל השינויים יבוצעו בקובץ `public/widget.js`.
*   ההטמעה באתר הלקוח תישאר שורת `<script>` אחת.